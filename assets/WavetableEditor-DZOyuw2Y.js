const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-zx6LJBPK.js","assets/vendor-react-DkDaD07v.js","assets/vendor-utils-XMmR-oGw.js","assets/vendor-tone-CADp_hfL.js","assets/vendor-ui-uomqNFY-.js","assets/index-Cnoi0D0R.css"])))=>i.map(i=>d[i]);
import{j as e,_ as t}from"./index-zx6LJBPK.js";import{r as s}from"./vendor-utils-XMmR-oGw.js";import"./EffectChain-C3LgFJxX.js";import"./sortable.esm-Nw3Rboz6.js";import{W as o}from"./WaveformThumbnail-BZo1r2_f.js";import{W as r,F as i,i as n,j as a,k as d,T as l,l as m}from"./vendor-ui-uomqNFY-.js";import"./vendor-react-DkDaD07v.js";import"./vendor-tone-CADp_hfL.js";import"./useVisualizationAnimation-D37DdYyX.js";const c=(e,t,s)=>{const o=[],r=s/2;for(let i=0;i<t;i++){const n=i/t;let a;switch(e){case"sine":a=Math.sin(2*n*Math.PI)*r+r;break;case"triangle":a=n<.5?4*n*r:4*(1-n)*r;break;case"saw":a=n*s;break;case"square":a=n<.5?s:0;break;case"pulse25":a=n<.25?s:0;break;case"pulse12":a=n<.125?s:0;break;case"noise":a=Math.random()*s;break;default:a=r}o.push(Math.round(Math.max(0,Math.min(s,a))))}return o},u=({wavetable:o,onChange:m,onRemove:u,height:b=180,color:v="#06b6d4"})=>{const x=s.useRef(null),p=s.useRef(null),[N,E]=s.useState(!1),[h,f]=s.useState(!1),D=o.max??15,V=o.data.length||32,C=(e,t)=>{if(e.length===t)return e;const s=[],o=e.length/t;for(let r=0;r<t;r++){const t=r*o,i=Math.floor(t),n=t-i,a=e[i],d=e[(i+1)%e.length];s.push(Math.round(a+(d-a)*n))}return s},g=s.useCallback(()=>{const e=x.current;if(!e)return;const t=e.getContext("2d");if(!t)return;const s=window.devicePixelRatio||1,r=Math.max(320,12*V),i=b;e.width=r*s,e.height=i*s,e.style.width=r+"px",e.style.height=i+"px",t.scale(s,s);const n=r,a=i;t.fillStyle="#1a1a2e",t.fillRect(0,0,n,a),t.strokeStyle="#2a2a4e",t.lineWidth=1;for(let o=1;o<4;o++){const e=a/4*o;t.beginPath(),t.moveTo(0,e),t.lineTo(n,e),t.stroke()}const d=Math.max(1,Math.floor(V/8));for(let o=0;o<V;o+=d){const e=o/V*n;t.beginPath(),t.moveTo(e,0),t.lineTo(e,a),t.stroke()}const l=n/V;o.data.forEach((e,s)=>{const o=s*l,r=e/D*a,i=a-r;t.fillStyle=v,t.fillRect(o,i,l-1,r)}),t.strokeStyle="rgba(255,255,255,0.5)",t.lineWidth=1,t.beginPath(),o.data.forEach((e,s)=>{const o=s/V*n+l/2,r=a-e/D*a;0===s?t.moveTo(o,r):t.lineTo(o,r)}),t.stroke()},[o,D,V,v,b]);s.useEffect(()=>{g()},[g]);const j=(e,t=!1)=>{if(!N&&!t)return;const s=x.current;if(!s)return;const r=s.getBoundingClientRect(),i=e.clientX-r.left,n=e.clientY-r.top,a=Math.floor(i/r.width*V),d=1-n/r.height,l=Math.round(d*D);if(a>=0&&a<V){const e=[...o.data];e[a]=Math.max(0,Math.min(D,l)),m({...o,data:e})}},W=e=>{if(e<4||e>256)return;const t=[];for(let s=0;s<e;s++){const r=s/e*o.data.length,i=Math.floor(r),n=Math.min(o.data.length-1,i+1),a=r-i,d=o.data[i]*(1-a)+o.data[n]*a;t.push(Math.round(d))}m({...o,data:t,len:e})};return e.jsxDEV("div",{className:"bg-dark-bgSecondary rounded-lg border border-dark-border overflow-hidden",children:[e.jsxDEV("div",{className:"flex items-center justify-between px-3 py-2 bg-dark-bg border-b border-dark-border",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV(r,{size:14,className:"text-cyan-400"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:320,columnNumber:11},void 0),e.jsxDEV("span",{className:"font-mono text-[10px] font-bold text-text-primary",children:["Wave ",o.id]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:321,columnNumber:11},void 0),e.jsxDEV("span",{className:"text-[9px] text-text-muted",children:[V,"×",D+1]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:324,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:319,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex items-center gap-1",children:[e.jsxDEV("button",{onClick:()=>p.current?.click(),className:"p-1 text-cyan-400 hover:bg-cyan-500/20 rounded",title:"Import .wav or .h wave",children:e.jsxDEV(i,{size:14},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:336,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:331,columnNumber:11},void 0),e.jsxDEV("input",{ref:p,type:"file",accept:".wav,.h",onChange:async e=>{const s=e.target.files?.[0];if(s){try{if(s.name.endsWith(".h")){const e=(await s.text()).split(/[\s,]+/).map(e=>parseInt(e)).filter(e=>!isNaN(e));if(e.length>0){const t=Math.max(...e),s=e.map(e=>Math.round(e/t*D)),r=C(s,V);m({...o,data:r})}}else{const{getDevilboxAudioContext:e}=await t(async()=>{const{getDevilboxAudioContext:e}=await import("./index-zx6LJBPK.js").then(e=>e.e2);return{getDevilboxAudioContext:e}},__vite__mapDeps([0,1,2,3,4,5]));let r;try{r=e()}catch{r=new AudioContext}const i=await s.arrayBuffer(),n=(await r.decodeAudioData(i)).getChannelData(0),a=Array.from(n).map(e=>Math.round((e+1)/2*D)),d=C(a,V);m({...o,data:d})}}catch(r){}p.current&&(p.current.value="")}},className:"hidden"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:338,columnNumber:11},void 0),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV("button",{onClick:()=>f(!h),className:"p-1 text-amber-400 hover:bg-amber-500/20 rounded",title:"Generate waveform",children:e.jsxDEV(n,{size:14},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:353,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:348,columnNumber:13},void 0),h&&e.jsxDEV("div",{className:"absolute top-full right-0 mt-1 bg-dark-bg border border-dark-border rounded shadow-lg z-20 min-w-[120px]",children:["sine","triangle","saw","square","pulse25","pulse12","noise"].map(t=>e.jsxDEV("button",{onClick:()=>(e=>{const t=c(e,V,D);m({...o,data:t}),f(!1)})(t),className:"w-full px-3 py-1.5 text-left text-[10px] font-mono text-text-primary hover:bg-dark-bgSecondary capitalize",children:t},t,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:359,columnNumber:19},void 0))},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:357,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:347,columnNumber:11},void 0),e.jsxDEV("button",{onClick:()=>{const e=o.data.map(e=>D-e);m({...o,data:e})},className:"p-1 text-text-muted hover:text-text-primary hover:bg-dark-border/50 rounded",title:"Invert",children:e.jsxDEV(a,{size:14},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:377,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:372,columnNumber:11},void 0),e.jsxDEV("button",{onClick:()=>{const e=Math.floor(D/2);m({...o,data:Array(V).fill(e)})},className:"p-1 text-text-muted hover:text-text-primary hover:bg-dark-border/50 rounded",title:"Clear",children:e.jsxDEV(d,{size:14},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:386,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:381,columnNumber:11},void 0),u&&e.jsxDEV("button",{onClick:u,className:"p-1 text-red-400 hover:text-red-300 hover:bg-red-500/20 rounded",title:"Remove wavetable",children:e.jsxDEV(l,{size:14},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:396,columnNumber:15},void 0)},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:391,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:329,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:318,columnNumber:7},void 0),e.jsxDEV("div",{className:"relative",children:e.jsxDEV("canvas",{ref:x,width:Math.max(320,12*V),height:b,className:"cursor-crosshair",onMouseDown:e=>{E(!0),j(e,!0)},onMouseMove:e=>j(e),onMouseUp:()=>E(!1),onMouseLeave:()=>E(!1)},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:404,columnNumber:9},void 0)},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:403,columnNumber:7},void 0),e.jsxDEV("div",{className:"flex items-center justify-between px-3 py-2 bg-dark-bg border-t border-dark-border text-[9px] font-mono",children:[e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("span",{className:"text-text-muted",children:"Length:"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:419,columnNumber:11},void 0),e.jsxDEV("button",{onClick:()=>W(V/2),className:"text-text-muted hover:text-text-primary",disabled:V<=4,children:"÷2"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:420,columnNumber:11},void 0),e.jsxDEV("span",{className:"text-text-primary",children:V},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:427,columnNumber:11},void 0),e.jsxDEV("button",{onClick:()=>W(2*V),className:"text-text-muted hover:text-text-primary",disabled:V>=256,children:"×2"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:428,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:418,columnNumber:9},void 0),e.jsxDEV("div",{className:"flex items-center gap-2",children:[e.jsxDEV("span",{className:"text-text-muted",children:"Height:"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:438,columnNumber:11},void 0),e.jsxDEV("select",{value:D,onChange:e=>(e=>{if(e<1||e>255)return;const t=e/D,s=o.data.map(e=>Math.round(e*t));m({...o,data:s,max:e})})(parseInt(e.target.value)),className:"bg-dark-bgSecondary border border-dark-border rounded px-1 py-0.5 text-text-primary",children:[e.jsxDEV("option",{value:3,children:"4"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:444,columnNumber:13},void 0),e.jsxDEV("option",{value:7,children:"8"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:445,columnNumber:13},void 0),e.jsxDEV("option",{value:15,children:"16"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:446,columnNumber:13},void 0),e.jsxDEV("option",{value:31,children:"32"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:447,columnNumber:13},void 0),e.jsxDEV("option",{value:63,children:"64"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:448,columnNumber:13},void 0),e.jsxDEV("option",{value:127,children:"128"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:449,columnNumber:13},void 0),e.jsxDEV("option",{value:255,children:"256"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:450,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:439,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:437,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:417,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:316,columnNumber:5},void 0)},b=({wavetables:t,onChange:i,maxWavetables:n=64})=>{const[d,l]=s.useState(t.length>0?0:null),b=()=>{if(t.length>=n)return;const e={id:t.length>0?Math.max(...t.map(e=>e.id))+1:0,data:c("sine",32,15),len:32,max:15};i([...t,e]),l(t.length)};return e.jsxDEV("div",{className:"space-y-3",children:[e.jsxDEV("div",{className:"flex items-center gap-2 flex-wrap",children:[t.map((t,s)=>{const r=d===s;return e.jsxDEV("button",{onClick:()=>l(s),className:"flex flex-col items-center gap-0.5 px-2 py-1 rounded border transition-colors\n                "+(r?"bg-cyan-500/20 border-cyan-500":"bg-dark-bg border-dark-border hover:border-dark-border/80"),children:[e.jsxDEV(o,{data:t.data,maxValue:t.max??15,width:52,height:18,color:r?"#22d3ee":"#4b5563",style:"bar"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:538,columnNumber:15},void 0),e.jsxDEV("span",{className:"font-mono text-[9px] "+(r?"text-cyan-400":"text-text-muted"),children:["Wave ",t.id]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:545,columnNumber:15},void 0)]},t.id,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:529,columnNumber:13},void 0)}),t.length<n&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("button",{onClick:b,className:"px-3 py-1.5 rounded border border-dashed border-dark-border text-text-muted hover:text-text-primary hover:border-accent text-[10px] font-mono flex items-center gap-1",children:[e.jsxDEV(m,{size:12},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:558,columnNumber:15},void 0),"Add"]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:554,columnNumber:13},void 0),null!==d&&e.jsxDEV("button",{onClick:()=>(e=>{if(t.length>=n)return;const s=t[e],o=Math.max(...t.map(e=>e.id))+1,r={...s,id:o,data:[...s.data]};i([...t,r]),l(t.length)})(d),className:"px-3 py-1.5 rounded border border-dashed border-dark-border text-text-muted hover:text-text-primary hover:border-cyan-500 text-[10px] font-mono flex items-center gap-1",children:[e.jsxDEV(a,{size:12},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:566,columnNumber:17},void 0),"Duplicate"]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:562,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:553,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:525,columnNumber:7},void 0),null!==d&&t[d]&&e.jsxDEV(u,{wavetable:t[d],onChange:e=>((e,s)=>{const o=[...t];o[e]=s,i(o)})(d,e),onRemove:t.length>1?()=>(e=>{const s=t.filter((t,s)=>s!==e);i(s),d===e?l(s.length>0?Math.min(e,s.length-1):null):null!==d&&d>e&&l(d-1)})(d):void 0},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:576,columnNumber:9},void 0),0===t.length&&e.jsxDEV("div",{className:"text-center py-8 text-text-muted text-sm",children:[e.jsxDEV(r,{size:32,className:"mx-auto mb-2 opacity-50"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:586,columnNumber:11},void 0),e.jsxDEV("p",{children:"No wavetables"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:587,columnNumber:11},void 0),e.jsxDEV("button",{onClick:b,className:"mt-2 text-accent hover:underline text-xs",children:"Add your first wavetable"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:588,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:585,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/editors/WavetableEditor.tsx",lineNumber:523,columnNumber:5},void 0)};export{u as WavetableEditor,b as WavetableListEditor,u as default};
