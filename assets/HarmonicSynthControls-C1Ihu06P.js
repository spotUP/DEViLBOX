import{aG as e,aO as o,j as n,aH as s}from"./index-zx6LJBPK.js";import{r as t}from"./vendor-utils-XMmR-oGw.js";import"./EffectChain-C3LgFJxX.js";import"./sortable.esm-Nw3Rboz6.js";import{E as r}from"./EnvelopeVisualization-BefL2nEr.js";import{F as i}from"./FilterFrequencyResponse-DzZRqLnc.js";import"./vendor-react-DkDaD07v.js";import"./vendor-tone-CADp_hfL.js";import"./vendor-ui-uomqNFY-.js";import"./useVisualizationAnimation-D37DdYyX.js";const l=32,m={Saw:Array.from({length:l},(e,o)=>1/(o+1)),Square:Array.from({length:l},(e,o)=>(o+1)%2==1?1/(o+1):0),Triangle:Array.from({length:l},(e,o)=>{if((o+1)%2==0)return 0;const n=o+1;return 1/(n*n)*(n%4==1?1:-1)}).map(e=>Math.abs(e)),Organ:Array.from({length:l},(e,o)=>{const n=o+1;return[1,2,3,4,5,6,8].includes(n)?.8/Math.sqrt(n):0}),Bell:Array.from({length:l},(e,o)=>{const n=o+1;return Math.exp(-.3*n)*(1+.5*Math.sin(.7*n))}),Choir:Array.from({length:l},(e,o)=>{const n=o+1,s=200*n;return(Math.exp(-((s-500)**2)/4e4)+.6*Math.exp(-((s-1500)**2)/16e4)+.3*Math.exp(-((s-2500)**2)/36e4))*(1/n)})};for(const a of Object.keys(m)){const e=m[a],o=Math.max(...e);o>0&&(m[a]=e.map(e=>e/o))}const c=({config:c,instrumentId:a,onChange:d})=>{const u=t.useRef(null),[p,x]=t.useState(!1),N="cyan-lineart"===e(e=>e.currentThemeId),b=N?"#00ffff":"#4ade80",v=N?"rgba(0, 255, 255, 0.7)":"rgba(74, 222, 128, 0.7)",h=N?"rgba(0, 255, 255, 1)":"rgba(74, 222, 128, 1)",f=N?"bg-[#051515] border-cyan-900/50":"bg-[#1a1a1a] border-gray-800",C=c.harmonics||o.harmonics,E=t.useCallback(()=>{const e=u.current;if(!e)return;const o=e.getContext("2d");if(!o)return;const n=window.devicePixelRatio||1,s=e.clientWidth,t=e.clientHeight;e.width=s*n,e.height=t*n,o.scale(n,n),o.fillStyle=N?"#030d0d":"#111111",o.fillRect(0,0,s,t),o.strokeStyle=N?"rgba(0, 255, 255, 0.06)":"rgba(255, 255, 255, 0.06)",o.lineWidth=1;for(let l=1;l<4;l++){const e=t/4*l;o.beginPath(),o.moveTo(0,e),o.lineTo(s,e),o.stroke()}const r=s/l,i=Math.max(1,.1*r);for(let m=0;m<l;m++){const e=(C[m]||0)*t,n=m*r+i/2,s=t-e,l=o.createLinearGradient(n,s,n,t);l.addColorStop(0,h),l.addColorStop(1,v),o.fillStyle=l,o.fillRect(n,s,r-i,e),(m+1)%4!=1&&0!==m||(o.fillStyle=N?"rgba(0, 255, 255, 0.4)":"rgba(255, 255, 255, 0.3)",o.font="9px monospace",o.textAlign="center",o.fillText(String(m+1),n+(r-i)/2,t-3))}},[C,N,v,h]);t.useEffect(()=>{E()},[E]);const V=t.useCallback(e=>{const o=u.current;if(!o)return;const n=o.getBoundingClientRect(),s=e.clientX-n.left,t=e.clientY-n.top,r=Math.floor(s/n.width*l),i=Math.max(0,Math.min(1,1-t/n.height));if(r>=0&&r<l){const e=[...C];e[r]=i,d({harmonics:e})}},[C,d]),D=t.useCallback(e=>{x(!0),V(e)},[V]),y=t.useCallback(e=>{p&&V(e)},[p,V]),g=t.useCallback(()=>{x(!1)},[]),j=e=>{d({filter:{...c.filter,...e}})},S=e=>{d({envelope:{...c.envelope,...e}})},O=e=>{d({lfo:{...c.lfo,...e}})};return n.jsxDEV("div",{className:"space-y-3",children:[n.jsxDEV("div",{className:`rounded-lg border ${f} overflow-hidden`,children:[n.jsxDEV("div",{className:"flex items-center justify-between px-3 py-1.5 border-b border-dark-border",children:[n.jsxDEV("span",{className:"font-mono text-[10px] font-bold text-text-primary tracking-wider",children:"HARMONICS"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:186,columnNumber:11},void 0),n.jsxDEV("div",{className:"flex items-center gap-1",children:Object.keys(m).map(e=>n.jsxDEV("button",{onClick:()=>d({harmonics:[...m[e]]}),className:"px-2 py-0.5 text-[9px] font-mono rounded border border-dark-border hover:border-accent text-text-muted hover:text-text-primary transition-colors",children:e},e,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:189,columnNumber:15},void 0))},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:187,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:185,columnNumber:9},void 0),n.jsxDEV("canvas",{ref:u,className:"w-full cursor-crosshair",style:{height:"120px"},onMouseDown:D,onMouseMove:y,onMouseUp:g,onMouseLeave:g},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:199,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:184,columnNumber:7},void 0),n.jsxDEV("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxDEV("div",{className:`rounded-lg border p-3 ${f}`,children:[n.jsxDEV("div",{className:"font-mono text-[10px] font-bold text-text-muted mb-2 tracking-wider",children:"SPECTRAL"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:214,columnNumber:11},void 0),n.jsxDEV("div",{className:"flex gap-4 justify-center",children:[n.jsxDEV(s,{value:c.spectralTilt,min:-100,max:100,onChange:e=>d({spectralTilt:e}),label:"Tilt",size:"sm",color:b,bipolar:!0,defaultValue:0},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:216,columnNumber:13},void 0),n.jsxDEV(s,{value:c.evenOddBalance,min:-100,max:100,onChange:e=>d({evenOddBalance:e}),label:"E/O",size:"sm",color:b,bipolar:!0,defaultValue:0},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:220,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:215,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:213,columnNumber:9},void 0),n.jsxDEV("div",{className:`rounded-lg border p-3 ${f}`,children:[n.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[n.jsxDEV("span",{className:"font-mono text-[10px] font-bold text-text-muted tracking-wider",children:"FILTER"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:230,columnNumber:13},void 0),n.jsxDEV("select",{value:c.filter.type,onChange:e=>j({type:e.target.value}),className:"bg-transparent border border-dark-border rounded px-1.5 py-0.5 text-[9px] font-mono text-text-primary",children:[n.jsxDEV("option",{value:"lowpass",children:"LP"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:236,columnNumber:15},void 0),n.jsxDEV("option",{value:"highpass",children:"HP"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:237,columnNumber:15},void 0),n.jsxDEV("option",{value:"bandpass",children:"BP"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:238,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:231,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:229,columnNumber:11},void 0),n.jsxDEV("div",{className:"mb-2",children:n.jsxDEV(i,{filterType:c.filter.type,cutoff:Math.log10(Math.max(c.filter.cutoff,20)/20)/3,resonance:c.filter.resonance/30,poles:2,color:b,width:300,height:56},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:242,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:241,columnNumber:11},void 0),n.jsxDEV("div",{className:"flex gap-4 justify-center",children:[n.jsxDEV(s,{value:c.filter.cutoff,min:20,max:2e4,onChange:e=>j({cutoff:e}),label:"Cutoff",unit:"Hz",size:"sm",color:b,logarithmic:!0},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:250,columnNumber:13},void 0),n.jsxDEV(s,{value:c.filter.resonance,min:0,max:30,onChange:e=>j({resonance:e}),label:"Reso",size:"sm",color:b},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:254,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:249,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:228,columnNumber:9},void 0),n.jsxDEV("div",{className:`rounded-lg border p-3 ${f}`,children:[n.jsxDEV("div",{className:"font-mono text-[10px] font-bold text-text-muted mb-2 tracking-wider",children:"ENVELOPE"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:263,columnNumber:11},void 0),n.jsxDEV("div",{className:"mb-2",children:n.jsxDEV(r,{mode:"linear",attack:c.envelope.attack/2e3,decay:c.envelope.decay/2e3,sustain:c.envelope.sustain/100,release:c.envelope.release/5e3,color:b,width:300,height:48},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:265,columnNumber:13},void 0)},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:264,columnNumber:11},void 0),n.jsxDEV("div",{className:"flex gap-3 justify-center",children:[n.jsxDEV(s,{value:c.envelope.attack,min:0,max:2e3,onChange:e=>S({attack:e}),label:"A",unit:"ms",size:"sm",color:b},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:276,columnNumber:13},void 0),n.jsxDEV(s,{value:c.envelope.decay,min:0,max:2e3,onChange:e=>S({decay:e}),label:"D",unit:"ms",size:"sm",color:b},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:280,columnNumber:13},void 0),n.jsxDEV(s,{value:c.envelope.sustain,min:0,max:100,onChange:e=>S({sustain:e}),label:"S",unit:"%",size:"sm",color:b},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:284,columnNumber:13},void 0),n.jsxDEV(s,{value:c.envelope.release,min:0,max:5e3,onChange:e=>S({release:e}),label:"R",unit:"ms",size:"sm",color:b},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:288,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:275,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:262,columnNumber:9},void 0),n.jsxDEV("div",{className:`rounded-lg border p-3 ${f}`,children:[n.jsxDEV("div",{className:"flex items-center justify-between mb-2",children:[n.jsxDEV("span",{className:"font-mono text-[10px] font-bold text-text-muted tracking-wider",children:"LFO"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:298,columnNumber:13},void 0),n.jsxDEV("select",{value:c.lfo.target,onChange:e=>O({target:e.target.value}),className:"bg-transparent border border-dark-border rounded px-1.5 py-0.5 text-[9px] font-mono text-text-primary",children:[n.jsxDEV("option",{value:"pitch",children:"Pitch"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:304,columnNumber:15},void 0),n.jsxDEV("option",{value:"filter",children:"Filter"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:305,columnNumber:15},void 0),n.jsxDEV("option",{value:"spectral",children:"Spectral"},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:306,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:299,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:297,columnNumber:11},void 0),n.jsxDEV("div",{className:"flex gap-4 justify-center",children:[n.jsxDEV(s,{value:c.lfo.rate,min:.1,max:20,onChange:e=>O({rate:e}),label:"Rate",unit:"Hz",size:"sm",color:b},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:310,columnNumber:13},void 0),n.jsxDEV(s,{value:c.lfo.depth,min:0,max:100,onChange:e=>O({depth:e}),label:"Depth",size:"sm",color:b},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:314,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:309,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:296,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:211,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/controls/HarmonicSynthControls.tsx",lineNumber:182,columnNumber:5},void 0)};export{c as HarmonicSynthControls};
