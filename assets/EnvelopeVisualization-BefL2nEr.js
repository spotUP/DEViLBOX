import{j as e}from"./index-zx6LJBPK.js";import{r as t}from"./vendor-utils-XMmR-oGw.js";const l="rgba(125, 211, 252, 0.35)",i="rgba(239, 68, 68, 0.18)",o=o=>{const n=t.useRef(null),a=o.width??280,s=o.height??72,r=o.color??"#7dd3fc",h=t.useCallback(()=>{const e=n.current;if(!e)return;const t=e.getContext("2d");if(!t)return;const h=window.devicePixelRatio||1;e.width=a*h,e.height=s*h,e.style.width=`${a}px`,e.style.height=`${s}px`,t.scale(h,h),t.fillStyle="#0d1117",t.fillRect(0,0,a,s),t.strokeStyle="#1e2a3a",t.lineWidth=1;for(let l=1;l<4;l++){const e=s/4*l;t.beginPath(),t.moveTo(0,e),t.lineTo(a,e),t.stroke()}"adsr"===o.mode?function(e,t,o,n,a){const s=n.maxTl??127,r=n.maxRate??31,h=n.d2r??0,c=1-n.tl/s,f=(r-n.ar)/r,d=n.sl/15*((r-n.dr)/r),m=(15-n.sl)/15*((31-h)/31),T=(15-n.rr)/15,x=.45*f,u=x+.45*d,y=u+.45*m,b=T,g=(1-c)*o,p=(1-c*(n.sl/15))*o;e.fillStyle=i,e.beginPath(),e.moveTo(0,g),e.lineTo(b*t,o),e.lineTo(0,o),e.closePath(),e.fill(),n.sl<15&&(e.strokeStyle=l,e.lineWidth=1,e.setLineDash([4,4]),e.beginPath(),e.moveTo(u*t,p),e.lineTo(t,p),e.stroke(),e.setLineDash([]));e.strokeStyle=a,e.lineWidth=2,e.beginPath(),e.moveTo(0,o),0===n.ar?e.lineTo(t,o):(e.lineTo(x*t,g),e.lineTo(u*t,p),h>0?e.lineTo(y*t,o):e.lineTo(t,p));e.stroke(),e.fillStyle="rgba(255,255,255,0.3)",e.font="8px monospace",e.fillText("A",x*t+2,g-3>8?g-3:g+9),e.fillText("D",u*t+2,p-3>8?p-3:9),e.fillText("R",2,o-4)}(t,a,s,o,r):"linear"===o.mode?function(e,t,i,o,n){const a=Math.max(0,Math.min(1,o.attack)),s=Math.max(0,Math.min(1,o.decay)),r=Math.max(0,Math.min(1,o.sustain)),h=Math.max(0,Math.min(1,o.release)),c=.25,f=a+s+c+h,d=e=>e/f*t,m=d(a),T=d(a+s),x=d(a+s+c),u=2,y=u+(1-r)*(i-u-2);e.fillStyle=l,e.fillRect(T,0,x-T,i),e.strokeStyle=n,e.lineWidth=2,e.lineJoin="round",e.beginPath(),e.moveTo(0,i),e.lineTo(m,u),e.lineTo(T,y),e.lineTo(x,y),e.lineTo(t,i),e.stroke(),e.fillStyle="rgba(255,255,255,0.3)",e.font="8px monospace",e.textAlign="center";const b=(e,t)=>(e+t)/2;m>10&&e.fillText("A",b(0,m),i-4);e.fillText("D",b(m,T),i-4),e.fillText("S",b(T,x),i-4),e.fillText("R",b(x,t),i-4),e.textAlign="left"}(t,a,s,o,r):function(e,t,i,o,n){const{attackVol:a,attackSpeed:s,decayVol:r,decaySpeed:h,sustainVol:c,sustainLen:f,releaseSpeed:d,maxVol:m}=o,T=o.releaseVol??0,x=Math.max(1,s+1),u=Math.max(1,h+1),y=Math.max(1,Math.min(f,48)),b=Math.max(1,d+1),g=x+u+y+b,p=e=>e/g*t,S=e=>i-e/m*i,k=p(x+u),v=p(x+u+y);e.fillStyle=l,e.fillRect(k,0,v-k,i),e.strokeStyle=n,e.lineWidth=2,e.lineJoin="round",e.beginPath(),e.moveTo(0,i);const M=p(x),R=p(x+u),D=v,P=p(g);e.lineTo(M,S(a)),e.lineTo(R,S(r)),e.lineTo(D,S(c)),e.lineTo(P,S(T)),e.stroke(),e.fillStyle="rgba(255,255,255,0.28)",e.font="8px monospace",e.fillText("A",2,i-4),e.fillText("D",M+2,i-4),e.fillText("S",k+3,i-4),e.fillText("R",D+2,i-4),e.strokeStyle=l,e.lineWidth=1,e.setLineDash([3,5]),e.beginPath(),e.moveTo(R,S(c)),e.lineTo(t,S(c)),e.stroke(),e.setLineDash([])}(t,a,s,o,r)},[o,a,s,r]);return t.useEffect(()=>{h()},[h]),e.jsxDEV("canvas",{ref:n,style:{display:"block",borderRadius:4,border:"1px solid rgba(255,255,255,0.06)"}},void 0,!1,{fileName:"/Users/spot/Code/DEViLBOX/src/components/instruments/shared/EnvelopeVisualization.tsx",lineNumber:145,columnNumber:5},void 0)};export{o as E};
