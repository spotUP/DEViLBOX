import{E as t,B as e,R as r,F as o,C as i,G as n,a as h}from"./PixiApp-DUEXYeX_.js";import"./index-zx6LJBPK.js";import"./vendor-react-DkDaD07v.js";import"./vendor-utils-XMmR-oGw.js";import"./vendor-tone-CADp_hfL.js";import"./vendor-ui-uomqNFY-.js";import"./react-three-fiber.esm-DUbY8J_y.js";import"./DJKeyboardHandler-Dzr29xNs.js";import"./parseModuleToSong-BCo4MrbT.js";import"./ArrangementKeyboardShortcuts-DvPf7hcZ.js";import"./VJView-BexYXGXr.js";var a=(t=>(t.Margin="margin",t.Padding="padding",t.Border="border",t.Flex="flex",t.Content="content",t))(a||{});function s(e,r){const o=`getComputed${r.charAt(0).toUpperCase()+r.slice(1)}`;return{top:e.yoga[o](t.Top),right:e.yoga[o](t.Right),bottom:e.yoga[o](t.Bottom),left:e.yoga[o](t.Left)}}function l(t,i){const{width:n,height:h}=t.computedLayout,a=s(t,"margin"),l=s(t,"border"),c=s(t,"padding"),d=i.get("margin");d.outer.x=-a.left,d.outer.y=-a.top,d.outer.width=n+a.left+a.right,d.outer.height=h+a.top+a.bottom,d.inner.x=0,d.inner.y=0,d.inner.width=n,d.inner.height=h;const g=i.get("border");g.outer.x=0,g.outer.y=0,g.outer.width=n,g.outer.height=h,g.inner.x=l.left,g.inner.y=l.top,g.inner.width=n-l.left-l.right,g.inner.height=h-l.top-l.bottom;const u=i.get("padding");u.outer.copyFrom(g.inner),u.inner.x=c.left+l.left,u.inner.y=c.top+l.top,u.inner.width=n-c.left-c.right-l.left-l.right,u.inner.height=h-c.top-c.bottom-l.top-l.bottom,function(t,i){var n;const h=i.get("flex"),a=i.get("padding");h.outer.copyFrom(a.inner);const s=new e,l=t.yoga.getChildCount();for(let e=0;e<l;e++){const o=t.yoga.getChild(e).getComputedLayout();s.addRect(new r(o.left,o.top,o.width,o.height))}const c=t.yoga.getFlexDirection();c===o.Column||c===o.ColumnReverse?(s.width=h.outer.width,s.x=h.outer.x):(s.height=h.outer.height,s.y=h.outer.y);null==(n=h.inner)||n.copyFrom(s.rectangle),i.get("content").outer.copyFrom(s.rectangle)}(t,i)}var c=Object.defineProperty,d=(t,e,r)=>((t,e,r)=>e in t?c(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r);class g extends i{constructor(){super(),d(this,"graphics"),d(this,"heatGraphics"),this.graphics=new Map,Object.values(a).forEach(t=>{const e=new n;this.graphics.set(t,e),this.addChild(e)}),this.heatGraphics=new n,this.addChild(this.heatGraphics)}init(t){const{target:e,alpha:r,heat:o}=t;t.heatOnly||Object.entries(t).forEach(([t,e])=>{if("target"===t||"alpha"===t||"heat"===t||"heatOnly"===t)return;const o=this.graphics.get(t);if(o&&e.draw)if(e.inner)this.drawCutBox(o,e.outer,e.inner,e.color,r);else{const{x:t,y:i,width:n,height:h}=e.outer;o.rect(t,i,n,Math.max(h,1)),o.fill({color:e.color,alpha:r})}});const{invalidationCount:i,draw:n}=o;if(i>0&&n){const e=20,r=Math.min(i/e,1),o=t[a.Margin],n=(h=[255,255,0],s=[255,0,0],l=r,`rgb(${Math.round(h[0]+(s[0]-h[0])*l)},${Math.round(h[1]+(s[1]-h[1])*l)},${Math.round(h[2]+(s[2]-h[2])*l)})`);this.heatGraphics.rect(o.outer.x,o.outer.y,o.outer.width,o.outer.height),this.heatGraphics.fill({color:n,alpha:Math.min(.3,r)}),this.heatGraphics.stroke({color:n,alpha:Math.max(.3,r),pixelLine:!0})}var h,s,l;this.position.set(e.x,e.y)}reset(){this.graphics.forEach(t=>t.clear()),this.heatGraphics.clear(),this.removeFromParent()}drawCutBox(t,e,r,o,i){const{x:n,y:h,width:a,height:s}=e,{x:l,y:c,width:d,height:g}=r;t.rect(n,h,a,s),t.fill({color:o,alpha:i}),t.rect(l,c,d,g),t.cut()}}var u=Object.defineProperty,p=(t,e,r)=>((t,e,r)=>e in t?u(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r);class m{constructor(){p(this,"holder",new i),p(this,"regions",new Map),p(this,"colors",{[a.Margin]:"#B68655",[a.Padding]:"#BAC57F",[a.Border]:"#E7C583",[a.Content]:"#89B1BE",[a.Flex]:"#6E28D9"}),p(this,"alpha",.75),Object.values(a).forEach(t=>{this.regions.set(t,{outer:new r,inner:new r})}),this.holder.__devtoolIgnore=!0,this.holder.__devtoolIgnoreChildren=!0,this.holder.eventMode="none",this.holder.interactiveChildren=!1}reset(){for(let t=this.holder.children.length-1;t>=0;t--){const e=this.holder.children[t];h.return(e)}}render(t){l(t,this.regions);const e=Object.values(a).reduce((e,r)=>{const o=this.regions.get(r);if(!o)return e;const i=`debugDraw${r.charAt(0).toUpperCase()}${r.slice(1)}`;return e[r]={...o,color:this.colors[r],draw:t._styles.custom[i]??!0},e},{}),{left:r,top:o}=t.computedLayout,i=t.target.getGlobalPosition(),n=h.get(g,{...e,target:{x:i.x+r,y:i.y+o},alpha:this.alpha,heat:{invalidationCount:t._modificationCount,draw:!1!==t._styles.custom.debugHeat},heatOnly:!t._styles.custom.debug});this.holder.addChildAt(n,0)}destroy(){this.reset(),this.holder.destroy(),this.regions.clear()}}export{m as DebugRenderer};
