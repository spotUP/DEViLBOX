import{b as e,S as t,j as r,q as s,T as a,D as n,r as l,s as i,t as o,v as c,w as d,y as x,z as m,A as u,B as b,C as h,E as p,G as y,H as g,I as f,J as j,K as v,L as k,M as N,N as S,O as w,P as z,Q as C,R as T,U as F,V as I,W as B,X as M,Y as E,Z as P}from"./index-B_tzmBrs.js";import{r as L,R as O}from"./vendor-utils-Cm-70yv0.js";import{T as A,E as D,S as $,U as K}from"./EffectChain-CBJG2Fll.js";import{a8 as W,X as H,d as R,am as q,al as V,e as G,a2 as U,n as X,E as J,b as Y,z as Z,l as Q,aO as _,C as ee,a4 as te}from"./vendor-ui-BuYJq6ba.js";import"./vendor-react-LeNVipsj.js";import"./vendor-tone-CADp_hfL.js";import"./ModuleRegistry-C5IxiZu0.js";import"./sortable.esm-_tstVFY2.js";const re="devilbox-synth-selector-category",se="devilbox-synth-selector-search",ae="devilbox-synth-selector-scroll",ne=({onSelect:j,compact:v=!1})=>{const k=e(e=>e.currentInstrumentId),N=e(e=>e.instruments),S=e(e=>e.updateInstrument),w=N.find(e=>e.id===k)||null,[z,C]=L.useState(null),[T,F]=L.useState(null),[I,B]=L.useState(()=>{try{return localStorage.getItem(se)||""}catch{return""}}),[M,E]=L.useState(()=>{try{return localStorage.getItem(re)||null}catch{return null}}),P=L.useRef(null),O=L.useRef(!1);L.useEffect(()=>{try{M?localStorage.setItem(re,M):localStorage.removeItem(re)}catch{}},[M]),L.useEffect(()=>{try{I?localStorage.setItem(se,I):localStorage.removeItem(se)}catch{}},[I]);const A=L.useCallback(()=>{if(O.current)return;const e=P.current;if(e)try{localStorage.setItem(ae,String(e.scrollTop))}catch{}},[]);L.useEffect(()=>{const e=P.current;e&&requestAnimationFrame(()=>{if(O.current=!0,w?.synthType){const t=e.querySelector(`[data-synth-type="${w.synthType}"]`);if(t)return t.scrollIntoView({block:"center",behavior:"instant"}),void setTimeout(()=>{O.current=!1},100)}try{const t=localStorage.getItem(ae);t&&(e.scrollTop=parseInt(t,10)||0)}catch{}setTimeout(()=>{O.current=!1},100)})},[]);const D=L.useMemo(()=>{const e=I.toLowerCase().trim();return t.filter(e=>!M||e.id===M).map(t=>({...t,synths:t.synths.filter(t=>!(!t||!t.icon)&&(!e||(t.name.toLowerCase().includes(e)||t.shortName.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.bestFor.some(t=>t.toLowerCase().includes(e)))))})).filter(e=>e.synths.length>0)},[I,M]),$=L.useMemo(()=>D.reduce((e,t)=>e+t.synths.length,0),[D]),K=e=>{if(!e)return q;try{return V[e]||q}catch(t){return q}},U=e=>{if(!w)return;a.getInstance().invalidateInstrument(w.id);const t={synthType:e,name:s(e).name,tb303:void 0,drumMachine:void 0,chipSynth:void 0,pwmSynth:void 0,wavetable:void 0,granular:void 0,superSaw:void 0,polySynth:void 0,organ:void 0,stringMachine:void 0,formantSynth:void 0,furnace:void 0,chiptuneModule:void 0,wobbleBass:void 0,drumKit:void 0};switch(e){case"TB303":t.tb303={...g};break;case"DrumMachine":t.drumMachine={...y};break;case"ChipSynth":t.chipSynth={...p};break;case"PWMSynth":t.pwmSynth={...h};break;case"Wavetable":t.wavetable={...b};break;case"GranularSynth":t.granular={...u};break;case"SuperSaw":t.superSaw={...m};break;case"PolySynth":t.polySynth={...x};break;case"Organ":t.organ={...d};break;case"StringMachine":t.stringMachine={...c};break;case"FormantSynth":t.formantSynth={...o};break;case"Furnace":t.furnace={...i};break;case"ChiptuneModule":t.chiptuneModule={...f};break;case"WobbleBass":t.wobbleBass={...l};break;case"DrumKit":t.drumKit={...n}}S(w.id,t),j?.(e)};if(v){const e=D.flatMap(e=>e.synths),t=Array.from(new Map(e.map(e=>[e.type,e])).values());return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"relative",children:[r.jsx(W,{size:14,className:"absolute left-2.5 top-1/2 -translate-y-1/2 text-text-muted"}),r.jsx("input",{type:"text",placeholder:"Search synths...",value:I,onChange:e=>B(e.target.value),className:"w-full pl-8 pr-8 py-1.5 text-sm bg-dark-bgSecondary border border-dark-border rounded-lg text-text-primary placeholder:text-text-muted focus:outline-none focus:border-accent-primary"}),I&&r.jsx("button",{onClick:()=>B(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary",children:r.jsx(H,{size:14})})]}),r.jsx("div",{className:"grid grid-cols-3 gap-2",children:t.map(e=>{const t=w?.synthType===e.type,s=K(e.icon);return r.jsxs("button",{"data-synth-type":e.type,onClick:()=>U(e.type),className:`\n                  flex items-center gap-2 p-2 rounded-lg border text-left transition-all\n                  ${t?"bg-accent-primary/15 border-accent-primary":"bg-dark-bgSecondary border-dark-border hover:border-text-muted"}\n                `,children:[r.jsx(s,{size:14,className:e.color}),r.jsx("span",{className:"text-sm truncate "+(t?"text-accent-primary":"text-text-secondary"),children:e.shortName})]},e.type)})}),0===t.length&&r.jsxs("div",{className:"text-center py-4 text-text-muted text-sm",children:['No synths found for "',I,'"']})]})}return r.jsxs("div",{ref:P,onScroll:A,className:"space-y-4 max-h-full overflow-y-auto",children:[r.jsxs("div",{className:"space-y-3 sticky top-0 bg-dark-bg pb-3 z-10",children:[r.jsxs("div",{className:"relative",children:[r.jsx(W,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),r.jsx("input",{type:"text",placeholder:"Search synths by name, description, or use case...",value:I,onChange:e=>B(e.target.value),className:"w-full pl-10 pr-10 py-2 text-sm bg-dark-bgSecondary border border-dark-border rounded-lg text-text-primary placeholder:text-text-muted focus:outline-none focus:border-accent-primary"}),I&&r.jsx("button",{onClick:()=>B(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary",children:r.jsx(H,{size:16})})]}),r.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[r.jsxs("button",{onClick:()=>E(null),className:"px-3 py-1 text-xs rounded-full border transition-all "+(null===M?"bg-accent-primary text-dark-bg border-accent-primary":"bg-dark-bgSecondary text-text-secondary border-dark-border hover:border-text-muted"),children:["All (",t.reduce((e,t)=>e+t.synths.filter(e=>e?.icon).length,0),")"]}),t.map(e=>{const t=e.synths.filter(e=>e?.icon).length;return r.jsxs("button",{onClick:()=>E(M===e.id?null:e.id),className:"px-3 py-1 text-xs rounded-full border transition-all "+(M===e.id?"bg-accent-primary text-dark-bg border-accent-primary":"bg-dark-bgSecondary text-text-secondary border-dark-border hover:border-text-muted"),children:[e.name," (",t,")"]},e.id)})]}),(I||M)&&r.jsxs("div",{className:"text-xs text-text-muted",children:["Showing ",$," synth",1!==$?"s":"",I&&` matching "${I}"`,M&&` in ${t.find(e=>e.id===M)?.name}`]})]}),D.map(e=>r.jsxs("div",{children:[r.jsxs("button",{onClick:()=>C(z===e.id?null:e.id),className:"w-full flex items-center justify-between mb-3 group",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:e.name}),r.jsx("p",{className:"text-xs text-text-muted",children:e.description})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs text-text-muted",children:e.synths.length}),r.jsx(R,{size:16,className:`\n                  text-text-muted transition-transform\n                  ${z===e.id?"rotate-90":""}\n                `})]})]}),(z===e.id||null===z)&&r.jsx("div",{className:"grid grid-cols-2 gap-3",children:e.synths.map(e=>((e,t)=>{if(!e||!e.icon)return null;const s=K(e.icon);return r.jsxs("div",{"data-synth-type":e.type,onClick:()=>U(e.type),onMouseEnter:()=>F(e.type),onMouseLeave:()=>F(null),className:`\n          relative p-4 rounded-lg border cursor-pointer transition-all\n          ${t?"bg-accent-primary/15 border-accent-primary":"bg-dark-bgSecondary border-dark-border hover:border-text-muted hover:bg-dark-bgHover"}\n        `,children:[t&&r.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 rounded-full bg-accent-primary flex items-center justify-center",children:r.jsx(G,{size:12,className:"text-dark-bg"})}),r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:`p-2 rounded-md bg-dark-bgTertiary ${e.color}`,children:r.jsx(s,{size:18})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-text-primary",children:e.name}),r.jsx("p",{className:"text-xs text-text-muted",children:e.shortName})]})]}),!v&&r.jsxs(r.Fragment,{children:[r.jsx("p",{className:"text-sm text-text-secondary mb-2",children:e.description}),r.jsx("div",{className:"flex flex-wrap gap-1",children:e.bestFor.slice(0,3).map(e=>r.jsx("span",{className:"px-2 py-0.5 text-[10px] rounded-full bg-dark-bgTertiary text-text-muted",children:e},e))})]})]},e.type)})(e,w?.synthType===e.type))})]},e.id)),0===D.length&&r.jsxs("div",{className:"text-center py-8 text-text-muted",children:[r.jsx("p",{className:"text-sm",children:"No synths found"}),r.jsx("p",{className:"text-xs mt-1",children:"Try a different search term or category"}),r.jsx("button",{onClick:()=>{B(""),E(null)},className:"mt-3 px-4 py-1.5 text-xs bg-dark-bgSecondary border border-dark-border rounded-lg hover:border-text-muted",children:"Clear filters"})]}),T&&r.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 bg-dark-bgTertiary border border-dark-border rounded-lg p-3 shadow-xl z-50 max-w-sm",children:(()=>{const e=s(T);if(!e||!e.icon)return null;const t=K(e.icon);return r.jsxs("div",{className:"flex gap-3",children:[r.jsx("div",{className:`p-2 rounded-md bg-dark-bg ${e.color}`,children:r.jsx(t,{size:20})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-text-primary",children:e.name}),r.jsx("p",{className:"text-xs text-text-secondary",children:e.description}),r.jsxs("p",{className:"text-[10px] text-text-muted mt-1",children:["Best for: ",e.bestFor.join(", ")]})]})]})})()})]})};const le=({iconName:e,size:t})=>{const r=V[e]||q;return O.createElement(r,{size:t})},ie=({isOpen:t,onClose:n,createMode:l=!1})=>{const i=e(e=>e.instruments),o=e(e=>e.currentInstrumentId),c=e(e=>e.createInstrument),d=e(e=>e.updateInstrument),x=e(e=>e.setPreviewInstrument),m=e(e=>e.setCurrentInstrument),u=i.find(e=>e.id===o)||null,[b,h]=L.useState(l),[p,y]=L.useState("TB303"),[g,f]=L.useState(""),[N,S]=L.useState("303 Classic"),[w,z]=L.useState(null),[F,I]=L.useState("sound"),[B,M]=L.useState(!0),[E,P]=L.useState(!1),[O,K]=L.useState(!1),[V,re]=L.useState(()=>{try{const e=localStorage.getItem("devilbox-editor-left-panel-collapsed");return null===e||"true"===e}catch{return!0}});L.useEffect(()=>{try{localStorage.setItem("devilbox-editor-left-panel-collapsed",String(V))}catch{}},[V]),L.useEffect(()=>{requestAnimationFrame(()=>{t&&l?(h(!0),y("TB303"),S("303 Classic"),z(ce("TB303"))):t&&!l&&(0===i.length?(h(!0),y("TB303"),S("303 Classic"),z(ce("TB303"))):u?(h(!1),z(null)):(h(!1),z(null),m(i[0].id)))})},[t,l,u,i,m]),L.useEffect(()=>{if(b&&w)return x(w),()=>x(null)},[b,w,x]);const se=()=>{x(null),h(!1),z(null),n()};L.useEffect(()=>{if(!t)return;const e=e=>{"Escape"===e.key&&(e.preventDefault(),se())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t,se]);const ae=j.filter(e=>{if(!g.trim())return!0;const t=v[e],r=g.toLowerCase();return t.name.toLowerCase().includes(r)||t.shortName.toLowerCase().includes(r)||t.description.toLowerCase().includes(r)||t.bestFor.some(e=>e.toLowerCase().includes(r))}),ie=()=>{x(null);const e=c();w&&d(e,{...w,name:N}),m(e),h(!1),z(null)},de=L.useCallback(e=>{a.getInstance().invalidateInstrument(-1),z(t=>t?{...t,...e}:null)},[]),xe=()=>{h(!0),y("TB303"),S("303 Classic"),z(ce("TB303"))},me=L.useCallback(()=>{I("sound")},[I]),ue=[...i].sort((e,t)=>e.id-t.id),be=ue.findIndex(e=>e.id===o),he=L.useCallback(()=>{be>0?m(ue[be-1].id):ue.length>0&&m(ue[ue.length-1].id)},[be,ue,m]),pe=L.useCallback(()=>{be<ue.length-1?m(ue[be+1].id):ue.length>0&&m(ue[0].id)},[be,ue,m]);if(!t)return null;const ye=b?w:u,ge=s(ye?.synthType?ye.synthType:"TB303");if(b)return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90",children:r.jsxs("div",{className:"w-full h-full bg-dark-bg flex flex-col overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-dark-bgSecondary border-b border-dark-border shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`p-1.5 rounded ${ge.color} bg-dark-bgTertiary`,children:r.jsx(le,{iconName:ge.icon,size:18})}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("h2",{className:"text-text-primary font-bold text-sm",children:"CREATE INSTRUMENT"}),r.jsx("input",{type:"text",value:N,onChange:e=>S(e.target.value),className:"px-3 py-1 text-sm bg-dark-bg border border-dark-border text-text-primary rounded focus:border-accent-primary focus:outline-none font-mono",placeholder:"Instrument name..."})]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("button",{onClick:se,className:"flex items-center gap-1.5 px-4 py-2 bg-red-900/50 text-red-300 text-sm font-bold hover:bg-red-800/60 hover:text-red-200 transition-colors rounded border border-red-700",children:[r.jsx(H,{size:14}),"Cancel"]}),r.jsxs("button",{onClick:ie,disabled:!N.trim(),className:"flex items-center gap-1.5 px-4 py-2 bg-green-600 text-white text-sm font-bold hover:bg-green-500 transition-colors rounded disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(G,{size:14}),"Add Instrument"]})]})]}),r.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[r.jsxs("div",{className:"w-64 shrink-0 bg-dark-bgSecondary border-r border-dark-border flex flex-col",children:[r.jsx("div",{className:"p-2 border-b border-dark-border",children:r.jsxs("div",{className:"relative",children:[r.jsx(W,{size:14,className:"absolute left-2 top-1/2 -translate-y-1/2 text-text-muted"}),r.jsx("input",{type:"text",value:g,onChange:e=>f(e.target.value),placeholder:"Search synths...",className:"w-full pl-7 pr-2 py-1.5 text-xs bg-dark-bg border border-dark-border text-text-primary rounded focus:border-accent-primary focus:outline-none"})]})}),r.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-modern",children:[ae.map(e=>{const t=v[e],n=p===e;return r.jsxs("button",{onClick:()=>(e=>{a.getInstance().invalidateInstrument(-1),y(e),z(ce(e)),S(s(e).name)})(e),className:`\n                        w-full px-2 py-1.5 text-left transition-all flex items-center gap-2 border-b border-dark-border\n                        ${n?"bg-accent-primary text-dark-bg":"hover:bg-dark-bgTertiary"}\n                      `,children:[r.jsx(le,{iconName:t.icon,size:14}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-bold text-xs truncate "+(n?"text-dark-bg":"text-text-primary"),children:t.shortName}),r.jsx("div",{className:"text-[10px] truncate "+(n?"text-dark-bg/70":"text-text-muted"),children:t.bestFor[0]})]})]},e)}),0===ae.length&&r.jsx("div",{className:"text-center py-4 text-text-muted text-xs",children:"No synths found"})]})]}),r.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[r.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-modern",children:w&&r.jsx(oe,{instrument:w,onChange:de})}),r.jsx("div",{className:"p-2 border-t border-dark-border bg-dark-bgSecondary shrink-0",children:w&&r.jsx(A,{instrument:w})})]})]})]})});const fe=[{id:"sound",label:"Sound",icon:Y},{id:"effects",label:"Effects",icon:Z}];return r.jsx("div",{className:"fixed inset-0 z-50 bg-black/90",children:r.jsxs("div",{className:"bg-dark-bg w-full h-full flex flex-col overflow-hidden",children:[r.jsxs("div",{className:"flex h-full",children:[r.jsx("div",{className:"border-r border-dark-border flex-shrink-0 bg-dark-bgSecondary transition-all duration-200 "+(V?"w-8":"w-52"),children:V?r.jsx("button",{onClick:()=>re(!1),className:"w-full h-full flex items-start justify-center pt-3 text-text-muted hover:text-text-primary hover:bg-dark-bgTertiary transition-colors",title:"Show instrument list",children:r.jsx(R,{size:16})}):r.jsxs("div",{className:"h-full flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between px-2 py-1 border-b border-dark-border",children:[r.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Instruments"}),r.jsx("button",{onClick:()=>re(!0),className:"p-1 text-text-muted hover:text-text-primary hover:bg-dark-bgTertiary rounded transition-colors",title:"Hide instrument list",children:r.jsx(U,{size:14})})]}),r.jsx("div",{className:"flex-1 overflow-hidden",children:r.jsx(k,{maxHeight:"100%",showActions:!0,onCreateNew:xe})})]})}),r.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[u?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-border bg-dark-bgSecondary",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:he,className:"p-1.5 rounded hover:bg-dark-bgTertiary text-text-muted hover:text-text-primary transition-colors",title:"Previous instrument",children:r.jsx(U,{size:20})}),r.jsx("div",{className:`p-2 rounded-lg bg-dark-bg ${ge?.color||"text-text-primary"}`,children:r.jsx(le,{iconName:ge.icon,size:20})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("input",{type:"text",value:u.name,onChange:e=>d(u.id,{name:e.target.value}),className:"bg-transparent text-text-primary font-semibold text-lg focus:outline-none focus:ring-1 focus:ring-accent-primary rounded px-1 -ml-1"}),r.jsxs("span",{className:"text-xs text-text-muted font-mono",children:["(",be+1,"/",ue.length,")"]})]}),r.jsxs("p",{className:"text-xs text-text-muted",children:[ge?.name||u.synthType," ",r.jsx("span",{className:"opacity-50",children:"|"})," ID: ",u.id.toString(16).toUpperCase().padStart(2,"0")]})]}),r.jsx("button",{onClick:pe,className:"p-1.5 rounded hover:bg-dark-bgTertiary text-text-muted hover:text-text-primary transition-colors",title:"Next instrument",children:r.jsx(R,{size:20})})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>K(!0),className:"flex items-center gap-1.5 px-3 py-1.5 rounded bg-dark-bg hover:bg-dark-bgTertiary text-text-primary transition-colors text-sm border border-dark-border",title:"Change synth type",children:[r.jsx(q,{size:14}),"Browse Synths"]}),r.jsxs("button",{onClick:()=>P(!0),className:"flex items-center gap-1.5 px-3 py-1.5 rounded bg-dark-bg hover:bg-dark-bgTertiary text-text-primary transition-colors text-sm border border-dark-border",title:"Save as preset",children:[r.jsx(X,{size:14}),"Save"]}),r.jsxs("button",{onClick:()=>{if(C.getState().instrumentEditorPoppedOut)return T("DEViLBOX â€” Instrument Editor"),void n();x(null),h(!1),z(null),n(),C.getState().setInstrumentEditorPoppedOut(!0)},className:"flex items-center gap-1.5 px-3 py-1.5 rounded bg-dark-bg hover:bg-dark-bgTertiary text-text-primary transition-colors text-sm border border-dark-border",title:"Pop out to separate window",children:[r.jsx(J,{size:14}),"Pop Out"]}),r.jsxs("button",{onClick:se,className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-dark-bg hover:bg-dark-bgHover transition-colors text-text-muted hover:text-text-primary border border-dark-border",title:"Close (Escape)",children:[r.jsx(H,{size:18}),r.jsx("span",{className:"text-sm font-medium",children:"Close"})]})]})]}),r.jsx("div",{className:"flex items-center gap-1 px-4 py-2 border-b border-dark-border bg-dark-bg",children:fe.map(e=>{const t=e.icon,s=F===e.id;return r.jsxs("button",{onClick:()=>I(e.id),className:`\n                          flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all border\n                          ${s?"bg-dark-bgSecondary text-accent-primary border-accent-primary":"text-text-muted hover:text-text-primary hover:bg-dark-bgSecondary border-transparent"}\n                        `,children:[r.jsx(t,{size:16}),e.label]},e.id)})}),r.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-modern",children:["sound"===F&&r.jsx("div",{className:"overflow-y-auto",children:r.jsx(oe,{instrument:u,onChange:e=>d(u.id,e)})}),"effects"===F&&r.jsx("div",{className:"p-4",children:r.jsx(D,{instrumentId:u.id,effects:u.effects||[]})})]}),O&&r.jsx("div",{className:"absolute inset-0 z-50 bg-black/80 flex items-center justify-center",children:r.jsxs("div",{className:"bg-dark-bg border border-dark-border rounded-lg shadow-2xl w-[90%] max-w-4xl max-h-[85vh] flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-border",children:[r.jsxs("h3",{className:"text-lg font-semibold text-text-primary flex items-center gap-2",children:[r.jsx(q,{size:20,className:"text-accent-primary"}),"Browse Synth Types"]}),r.jsx("button",{onClick:()=>K(!1),className:"p-1.5 rounded hover:bg-dark-bgHover text-text-muted hover:text-text-primary transition-colors",children:r.jsx(H,{size:18})})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:r.jsx(ne,{onSelect:e=>{me(e),K(!1)}})})]})})]}):r.jsxs("div",{className:"flex-1 flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-border bg-dark-bgSecondary",children:[r.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Instrument Editor"}),r.jsxs("button",{onClick:se,className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-dark-bg hover:bg-dark-bgHover transition-colors text-text-muted hover:text-text-primary border border-dark-border",title:"Close (Escape)",children:[r.jsx(H,{size:18}),r.jsx("span",{className:"text-sm font-medium",children:"Close"})]})]}),r.jsx("div",{className:"flex-1 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(q,{size:48,className:"mx-auto mb-4 opacity-50 text-text-muted"}),r.jsx("p",{className:"text-text-muted mb-2",children:"No instrument selected"}),r.jsx("p",{className:"text-text-muted text-sm mb-4",children:"Select an instrument from the list or create a new one"}),r.jsxs("button",{onClick:xe,className:"flex items-center gap-2 px-4 py-2 bg-accent-primary rounded-lg text-text-inverse hover:bg-accent-primary/80 transition-colors mx-auto",children:[r.jsx(Q,{size:16}),"Create Instrument"]})]})})]}),u&&r.jsxs("div",{className:"border-t border-dark-border",children:[r.jsxs("button",{onClick:()=>M(!B),className:"w-full px-4 py-2 flex items-center justify-between text-sm text-text-muted hover:text-text-primary hover:bg-dark-bgHover transition-colors",children:[r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx(_,{size:14}),"Test Keyboard"]}),B?r.jsx(ee,{size:14}):r.jsx(te,{size:14})]}),B&&r.jsx("div",{className:"p-4 bg-dark-bgSecondary",children:r.jsx(A,{instrument:u})})]})]})]}),E&&u&&r.jsx($,{instrument:u,onClose:()=>P(!1)})]})})},oe=({instrument:e,onChange:t})=>r.jsx("div",{className:"instrument-editor-wrapper",children:r.jsx(K,{instrument:e,onChange:t})});function ce(e){const t={id:-1,name:s(e).name,type:"synth",synthType:e,volume:-6,pan:0,oscillator:z,envelope:w,filter:S,effects:[]};if("TB303"===e||"Buzz3o3"===e)t.tb303={...g},"Buzz3o3"===e&&(t.buzzmachine={...F,machineType:"OomekAggressor",parameters:{0:0,1:120,2:64,3:64,4:64,5:64,6:100,7:100}});else if(function(e){return"Furnace"===e||e.startsWith("Furnace")}(e)){t.furnace={...i};const r={Furnace:1,FurnaceOPN:0,FurnaceOPNA:13,FurnaceOPNB:14,FurnaceOPM:1,FurnaceOPL:2,FurnaceOPLL:23,FurnaceOPL4:26,FurnaceOPZ:24,FurnaceESFM:25,FurnaceNES:3,FurnaceGB:4,FurnaceC64:5,FurnaceSID6581:5,FurnaceSID8580:5,FurnaceAY:6,FurnacePSG:7,FurnaceTIA:8,FurnaceVERA:9,FurnaceSAA:10,FurnaceVIC:11,FurnaceLynx:12};void 0!==r[e]&&(t.furnace.chipType=r[e])}else if(function(e){return"Buzzmachine"===e||e.startsWith("Buzz")}(e)){t.buzzmachine={...F};const r={Buzzmachine:"ArguruDistortion",BuzzDTMF:"CyanPhaseDTMF",BuzzFreqBomb:"ElenzilFrequencyBomb",BuzzKick:"FSMKick",BuzzKickXP:"FSMKickXP",BuzzNoise:"JeskolaNoise",BuzzTrilok:"JeskolaTrilok",Buzz4FM2F:"MadBrain4FM2F",BuzzDynamite6:"MadBrainDynamite6",BuzzM3:"MakkM3",Buzz3o3:"OomekAggressor"};r[e]&&(t.buzzmachine.machineType=r[e])}else if("GranularSynth"===e)t.granular={...u};else if("DrumKit"===e)t.drumKit={...n};else if("Sam"===e)t.sam={...I};else if("V2"===e)t.v2={...B};else if("Sampler"!==e&&"Player"!==e&&"ChiptuneModule"!==e)switch(e){case"DrumMachine":t.drumMachine={...y};break;case"ChipSynth":t.chipSynth={...p};break;case"PWMSynth":t.pwmSynth={...h};break;case"Wavetable":t.wavetable={...b};break;case"SuperSaw":t.superSaw={...m};break;case"PolySynth":t.polySynth={...x};break;case"Organ":t.organ={...d};break;case"StringMachine":t.stringMachine={...c};break;case"FormantSynth":t.formantSynth={...o};break;case"WobbleBass":t.wobbleBass={...l};break;case"DubSiren":t.dubSiren={...P};break;case"SpaceLaser":t.spaceLaser={...E};break;case"Synare":t.synare={...M}}const r=t.furnace?.chipType,a=t.buzzmachine?.machineType,f=N(e);if(f){const n={...f};delete n.name,delete n.type,delete n.synthType,Object.assign(t,n),t.synthType=e,t.id=-1,t.name=s(e).name,void 0!==r&&t.furnace&&(t.furnace.chipType=r),a&&t.buzzmachine&&(t.buzzmachine.machineType=a)}return t}export{ie as EditInstrumentModal};
