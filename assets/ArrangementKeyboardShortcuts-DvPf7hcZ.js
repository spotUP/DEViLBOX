import{r as e}from"./vendor-utils-XMmR-oGw.js";import{r as t,s}from"./index-zx6LJBPK.js";const i=[.5,1,2,4,8,12,16,24,32],o=()=>{e.useEffect(()=>{const e=e=>{const o=t.getState(),n=e.metaKey||e.ctrlKey,r=()=>{e.preventDefault(),e.stopPropagation()};if(!n||"d"!==e.key||e.shiftKey)if(n&&"j"===e.key)o.selectedClipIds.size>1&&(r(),function(e){const t=e.clips.filter(t=>e.selectedClipIds.has(t.id));if(t.length<2)return;const i=Math.min(...t.map(e=>e.startRow)),o=Math.max(...t.map(e=>{const t=e.clipLengthRows??64;return e.startRow+t})),n=t[0].trackId;if(0===s.getState().patterns.length)return;const r=e.addClip({patternId:t[0].patternId,trackId:n,startRow:i,offsetRows:0,clipLengthRows:o-i,sourceChannelIndex:0,color:t[0].color,muted:!1});e.removeClips([...e.selectedClipIds]),e.clearSelection(),e.selectClip(r)}(o));else if(n&&"e"===e.key){if(o.selectedClipIds.size>0){r();const e=o.playbackRow;for(const t of o.selectedClipIds)o.splitClip(t,e)}}else{if(n&&"l"===e.key)return r(),void function(e){const t=e.clips.filter(t=>e.selectedClipIds.has(t.id));if(0===t.length)return void e.clearLoopRegion();const s=Math.min(...t.map(e=>e.startRow)),i=Math.max(...t.map(e=>{const t=e.clipLengthRows??64;return e.startRow+t}));e.setLoopRegion(s,i)}(o);if(n&&"a"===e.key&&!e.shiftKey){r();const e=o.clips.map(e=>e.id);return void o.selectClips(e)}if(n&&e.shiftKey&&"a"===e.key)return r(),void o.clearSelection();if("Delete"!==e.key&&"Backspace"!==e.key||e.metaKey||e.ctrlKey){if("Tab"===e.key)return r(),void o.setTool("draw"===o.tool?"select":"draw");if(e.key>="1"&&e.key<="9"&&!n&&!e.shiftKey){const t=parseInt(e.key)-1;return void(t<i.length&&(r(),o.setPixelsPerRow(i[t])))}if("0"===e.key&&!n)return r(),void o.zoomToFit();if(n&&e.shiftKey&&"m"===e.key)return r(),void function(e){const t=s.getState().patterns;if(0===t.length)return;let i=e.selectedTrackId;!i&&e.tracks.length>0&&(i=e.tracks[0].id);if(!i)return;const o=e.view.snapDivision||1,n=Math.floor(e.playbackRow/o)*o;e.addClip({patternId:t[0].id,trackId:i,startRow:n,offsetRows:0,clipLengthRows:t[0].length,sourceChannelIndex:0,color:null,muted:!1})}(o);if("ArrowLeft"===e.key&&!n){r();const e=o.view.snapDivision||1;return void o.setPlaybackRow(Math.max(0,o.playbackRow-e))}if("ArrowRight"===e.key&&!n){r();const e=o.view.snapDivision||1;return void o.setPlaybackRow(o.playbackRow+e)}}else o.selectedClipIds.size>0&&(r(),o.removeClips([...o.selectedClipIds]))}else if(o.selectedClipIds.size>0){r();const e=o.duplicateClips([...o.selectedClipIds]);o.clearSelection(),o.selectClips(e)}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[])};export{o as u};
