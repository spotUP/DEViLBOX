function n(n,t){return(n[t]<<8|n[t+1])>>>0}function t(n){const t=n instanceof Uint8Array?n:new Uint8Array(n);if(t.length<8)return!1;if(80!==t[0]||65!==t[1]||110!==t[2]||16!==t[3])return!1;const e=function(n,t){return(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0}(t,4);return 0!==e&&!(2147483648&e)}function e(e,r){const o=new Uint8Array(e);if(!t(o))throw new Error("Not an Alcatraz Packer module");const a=r.split("/").pop()??r,i=a.replace(/^alp\./i,"").replace(/\.alp$/i,"")||a;let l=0,s=1;if(o.length>=12){const t=n(o,8)>>4;t>0&&(l=Math.min(t,31));const e=n(o,10)>>1;e>0&&(s=e)}const u=Math.max(l,1),c=Array.from({length:u},(n,t)=>({id:t+1,name:`Sample ${t+1}`,type:"synth",synthType:"Synth",effects:[],volume:0,pan:0})),m=Array.from({length:64},()=>({note:0,instrument:0,volume:0,effTyp:0,eff:0,effTyp2:0,eff2:0})),f={id:"pattern-0",name:"Pattern 0",length:64,channels:Array.from({length:4},(n,t)=>({id:`channel-${t}`,name:`Channel ${t+1}`,muted:!1,solo:!1,collapsed:!1,volume:100,pan:0===t||3===t?-50:50,instrumentId:null,color:null,rows:m})),importMetadata:{sourceFormat:"MOD",sourceFile:r,importedAt:(new Date).toISOString(),originalChannelCount:4,originalPatternCount:1,originalInstrumentCount:l}},p=[`${i} [Alcatraz Packer]`];return l>0&&p.push(`(${l} smp)`),{name:p.join(" "),format:"MOD",patterns:[f],instruments:c,songPositions:[0],songLength:s,restartPosition:0,numChannels:4,initialSpeed:6,initialBPM:125,linearPeriods:!1}}export{t as isAlcatrazPackerFormat,e as parseAlcatrazPackerFile};
