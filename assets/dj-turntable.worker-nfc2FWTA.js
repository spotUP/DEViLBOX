!function(){"use strict";const e={A:"#60a5fa",B:"#f87171",C:"#34d399"},t={A:"#1e2a3f",B:"#3f1e2a",C:"#1e3f2a"},a=.5556;let i=null,l=null,r=1,o=96,n=96,s={bg:"#0b0909",bgSecondary:"#131010",bgTertiary:"#1d1818",border:"#2f2525",borderLight:"#403535"},h="A",c=!1,d=120,f=1,b=!1,g=0,y=0,M=!0;self.onmessage=k=>{const P=k.data;switch(P.type){case"init":i=P.canvas,i.width=Math.round(P.width*P.dpr),i.height=Math.round(P.height*P.dpr),l=i.getContext("2d"),r=P.dpr,o=P.width,n=P.height,s=P.colors,h=P.deckId,c=P.isPlaying,d=P.effectiveBPM,function(){const i=k=>{c||M?function(i){if(!l)return;if(M=!1,y>0&&c){const e=(i-y)/1e3;g+=2*(d/120*a*f)*Math.PI*e}y=i,l.setTransform(r,0,0,r,0,0);const k=o/2,P=n/2,u=Math.min(k,P)-2,S=.38*u,p=e[h],m=t[h];l.fillStyle=s.bg,l.fillRect(0,0,o,n),l.beginPath(),l.arc(k,P,u,0,2*Math.PI),l.fillStyle=s.bgSecondary,l.fill(),l.strokeStyle=s.border,l.lineWidth=1,l.stroke(),l.beginPath(),l.arc(k,P,u-3,0,2*Math.PI),l.fillStyle=s.bg,l.fill();const A=S+4,v=u-6;l.lineWidth=.5;for(let e=0;e<14;e++){const t=A+e/13*(v-A);l.beginPath(),l.arc(k,P,t,0,2*Math.PI),l.strokeStyle=s.bgTertiary,l.globalAlpha=.25+.15*Math.sin(1.7*e),l.stroke()}l.globalAlpha=1,l.beginPath(),l.moveTo(k+Math.cos(g)*S,P+Math.sin(g)*S),l.lineTo(k+Math.cos(g)*(u-4),P+Math.sin(g)*(u-4)),l.strokeStyle=p,l.lineWidth=1.5,l.stroke(),l.beginPath(),l.arc(k,P,S,0,2*Math.PI),l.fillStyle=m,l.fill(),l.strokeStyle=s.border,l.lineWidth=.5,l.stroke(),b&&(l.font=`bold ${Math.round(.45*S)}px monospace`,l.fillStyle=p,l.textAlign="center",l.textBaseline="middle",l.fillText("SCR",k,P));l.beginPath(),l.arc(k,P,2,0,2*Math.PI),l.fillStyle=s.borderLight,l.fill(),l.strokeStyle=s.border,l.lineWidth=1,l.strokeRect(.5,.5,o-1,n-1)}(k):y=k,requestAnimationFrame(i)};requestAnimationFrame(i)}(),self.postMessage({type:"ready"});break;case"playback":c=P.isPlaying,d=P.effectiveBPM,M=!0;break;case"velocity":f=P.v,M=!0;break;case"scratchActive":b=P.active,M=!0;break;case"resize":r=P.dpr,o=P.w,n=P.h,i&&(i.width=Math.round(o*r),i.height=Math.round(n*r)),M=!0;break;case"colors":s=P.colors,M=!0}}}();
